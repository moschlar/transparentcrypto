<!-- https://cytoscape.github.io/cytoscape.js/#top -->
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">

<script src="resource://transparentcrypto/util.jsm" charset="utf-8"></script>

<script src="chrome://transparentcrypto/content/lib/cytoscape.min.js" charset="utf-8"></script>
<script src="./lib/cytoscape.min.js" charset="utf-8"></script>

</head>

<body>

<div id="container" style="width: 100%; height: 100%; position: absolute; left: 0; top: 0;"></div>

<script type="text/javascript">

    try {
      var _data = window.top._data_cy;
      //log("graph_cy.html: " + JSON.stringify(_data));
    } catch (ex) {console.log(ex);}


    try {
        // initialise cytoscape.js on a html dom element with some options:
        cy = cytoscape( options = {
          container: document.getElementById('container'),

          minZoom: 0.5,
          maxZoom: 2,

          // style can be specified as plain JSON, a stylesheet string (probably a CSS-like
          // file pulled from the server), or in a functional format
          style: [
            {
              selector: 'node',
              css: {
                'content': 'data(name)',
                'font-family': 'sans-serif',
                'font-size': 10,
                'text-outline-width': 0,
                'text-outline-color': '#888',
                'text-valign': 'center',
                'color': '#000',
    /*            'width': 'mapData(weight, 30, 80, 20, 50)',
                'height': 'mapData(height, 0, 200, 10, 45)',*/
                'width': '20px',
                'height': '10px',
                'border-color': '#fff'
              }
            },

            {
              selector: ':selected',
              css: {
                'background-color': '#000',
                'line-color': '#000',
                'target-arrow-color': '#000',
                'text-outline-color': '#000'
              }
            },

            {
              selector: 'edge',
              css: {
                'width': 2,
                'target-arrow-shape': 'triangle'
              }
            }
          ],
/*
          layout: {
            name: 'breadthfirst',

            fit: true, // whether to fit the viewport to the graph
            ready: undefined, // callback on layoutready
            stop: undefined, // callback on layoutstop
            directed: true, // whether the tree is directed downwards (or edges can point in any direction if false)
            padding: 10, // padding on fit
            circle: false, // put depths in concentric circles if true, put depths top down if false
            roots: undefined, // the roots of the trees
            maximalAdjustments: 0 // how many times to try to position the nodes in a maximal way (i.e. no backtracking)
          },
*/

          layout: {
              name: 'concentric',

              fit: true, // whether to fit the viewport to the graph
              ready: undefined, // callback on layoutready
              stop: undefined, // callback on layoutstop
              //padding: 30, // the padding on fit
              //startAngle: 3/2 * Math.PI, // the position of the first node
              counterclockwise: false, // whether the layout should go counterclockwise (true) or clockwise (false)
              minNodeSpacing: 10, // min spacing between outside of nodes (used for radius adjustment)
              height: undefined, // height of layout area (overrides container height)
              width: undefined, // width of layout area (overrides container width)
              concentric: function(){ // returns numeric value for each node, placing higher nodes in levels towards the centre
                //console.log(this.data("id"));
                //console.log(-this.data("level"));
                return -this.data("level");
              },
              levelWidth: function(nodes){ // the variation of concentric values in each level
                return 1;
              }
          },

          // specify the elements in the graph
          elements: _data,
        }
      );
    } catch (ex) {console.log(ex);}
</script>

</body>

</html>
